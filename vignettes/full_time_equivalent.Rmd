---
title: "FTE Enrollment"
subtitle: "Full time equivalent enrollment"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{full_time_equivalent}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo = FALSE}
library(utDataStoR)
library(readr)
```


Full-Time Equivalent (FTE) is the number of students the university would have if all students were attending full-time. It is calculated on course level student credit hours.

FTE for undergraduate students takes the total undergraduate student credit hours and divides it by 15 credit hours. FTE for graduate students takes the total graduate student credit hours and divides it by 10 credit hours. The institutions FTE is the sum of undergraduate and graduate FTE.


## Current FTE
The Current FTE reflects the live count of FTE for a term, which can fluctuate daily and may be adjusted post-semester for changes like withdrawals.

``` sql
`r display_sql_with_comments('fte', 'fte_total_current.sql')`
```

``` sql
/*
This SQL query calculates Full-Time Equivalent (FTE) values for graduate, undergraduate, and total students enrolled in current versions of courses.
Does not include any fte for CE - Continuing Education courses
*/
WITH CTE_graduate_fte AS
         (SELECT a.term_id,
                 ROUND(SUM(a.attempted_credits) / 10, 2) as current_graduate_fte
          FROM export.student_section_version a
          WHERE a.is_enrolled IS TRUE
            AND a.version_desc = 'Current'
            AND a.course_level_id = 'GR'
          GROUP BY a.term_id),

     CTE_undergrad_fte AS
         (SELECT a.term_id,
                 ROUND(SUM(a.attempted_credits) / 15, 2) as current_undergrad_fte
          FROM export.student_section_version a
          WHERE a.is_enrolled IS TRUE
            AND a.version_desc = 'Current'
            AND a.course_level_id = 'UG'
          GROUP BY a.term_id)

SELECT b.term_desc,
       COALESCE(d.current_undergrad_fte, 0) AS current_undergrad_fte,
       COALESCE(c.current_graduate_fte, 0) AS current_graduate_fte,
       ROUND(COALESCE(c.current_graduate_fte, 0) + COALESCE(d.current_undergrad_fte, 0), 2) AS current_total_fte
FROM export.student_section_version a
         LEFT JOIN export.term b
                   ON a.term_id = b.term_id
         LEFT JOIN CTE_graduate_fte c
                   ON a.term_id = c.term_id
         LEFT JOIN CTE_undergrad_fte d
                   ON a.term_id = d.term_id
WHERE a.is_enrolled IS TRUE
  AND a.version_desc = 'Current'
  AND DATE_PART('year', NOW()) - b.academic_year_code :: INT <= 5 -- Current year plus last 5 years
GROUP BY b.term_desc, c.current_graduate_fte, d.current_undergrad_fte
ORDER BY b.term_desc;
```

## Census FTE
The Census FTE is a fixed sum of FTE at the 15th day of the term, used for static reporting.


<!-- ``` sql -->
<!-- `r display_sql_with_comments('fte', 'fte_gr_cred_hour_census.sql')` -->
<!-- ``` -->

FTE is reported to USHE five times per fiscal year:

-   Summer End of Term
-   Fall 3rd Week Census
-   Fall End of Term
-   Spring 3rd Week Census
-   Spring End of Term

USHE summarizes FTE by credit hour type, residency, gender, and budget.

IPEDS calculates FTE in the 12 Month Enrollment survey based on a reporting calendar from July 1, 20XX - June 20YY. Utah Tech excludes Summer academic terms and reports Spring and Fall term census data.
